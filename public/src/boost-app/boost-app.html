<link rel="import" href="../../bower_components/polymer/polymer-element.html">

<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">

<link rel="import" href="../../bower_components/paper-styles/typography.html">
<link rel="import" href="../../bower_components/paper-styles/default-theme.html">

<link rel="import" href="../../bower_components/app-layout/app-layout.html">

<link rel="import" href="../../bower_components/feathersjs-client/feathersjs-client.html">

<link rel="import" href="./boost-login.html">
<link rel="import" href="./boost-toolbar.html">
<link rel="import" href="./feathersjs-auth.html">
<link rel="import" href="./boost-playlists.html">

<dom-module id="boost-app">
  <template>
    <style is="custom-styles">
      :host {
        display: block;
        @apply --paper-font-common;
        height: 100vh;
        background-color: var(--primary-background-color);
      }

      div#content {
        padding-top: 10px;
      }

      app-header-layout {
        z-index: 10;
      }

    </style>

    <feathersjs-client app="{{feathersApp}}" server="http://localhost:3030"
                       connected="{{connected}}"></feathersjs-client>
    <feathersjs-auth app="[[feathersApp]]" connected="[[connected]]" logged-in="{{loggedIn}}"></feathersjs-auth>

    <app-header-layout>
      <app-header fixed slot="header">
        <boost-toolbar logged-in="[[loggedIn]]" on-sign-out="signOut"></boost-toolbar>
      </app-header>

    </app-header-layout>

    <boost-login on-sign-in="signIn" logged-in="[[loggedIn]]" disabled="[[!connected]]"></boost-login>

    <boost-playlists app="[[feathersApp]]" logged-in="[[loggedIn]]"></boost-playlists>
  </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class BoostApp extends Polymer.Element {
      static get is() {
        return 'boost-app';
      }

      signIn() {
        window.location = "http://localhost:3030/auth/spotify";
      }

      signOut() {
        this.feathersApp.logout().then(() => {
          this.loggedIn = false;
        });
      }
    }

    window.customElements.define(BoostApp.is, BoostApp);

  </script>
</dom-module>
